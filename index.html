<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <title>Let's unit test your code</title>

    <link rel="stylesheet" href="css/reveal.css">
    <link rel="stylesheet" href="css/theme/black.css">

    <!-- Theme used for syntax highlighting of code -->
    <link rel="stylesheet" href="lib/css/zenburn.css">

    <style>
    #branding {
      font-family: 'Open Sans';
      font-size: 1em;
      font-weight: 700;
      color: #b5cce8;
      position: absolute;
      bottom: 0.1em;
      left: 0.1em;
    }
    </style>

    <!-- Printing and PDF exports -->
    <script>
      var link = document.createElement( 'link' );
      link.rel = 'stylesheet';
      link.type = 'text/css';
      link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
      document.getElementsByTagName( 'head' )[0].appendChild( link );
    </script>
  </head>
  <body>
    <div class="reveal">
      <div class="slides">
        <div id="branding">
          Dcycle
        </div>

        <section>
          <h2>Let's unit test your code</h2>
          <p>by Albert Albala</p>
          <p>@alberto56 - Dcycle.com</p>
          <p>https://alberto56.github.io/presentation_lets_unit_test/#/</p>
          <p><a href="https://github.com/alberto56/presentation_lets_unit_test">Fork me</a></p>
        </section>

        <section>
          <h2>Introductions</h2>
          <ul>
            <li>Developers?</li>
            <li>Project managers?</li>
            <li>Themers?</li>
            <li>Unit testing and PHPUnit experience?</li>
          </ul>
        </section>

        <section>
          <h2>Topics covered</h2>
          <ul>
            <li>The test pyramid</li>
            <li>Small functions that do one thing</li>
            <li>Making legacy code testable</li>
            <li>Getting value from tests: CI and Docker</li>
            <li>Cool PHPUnit features: Providers, Mocking, Stubbing, Testing exceptions, Expectations, Traits, Autoloading</li>
            <li>Why not to use static methods</li>
            <li>What next?</li>
            <li>Questions</li>
          </ul>
        </section>

        <section>
          <h2>The test pyramid</h2>
          <img src="images/pyramid.png" alt="The test pyramid: unit testing is faster and cheaper; UI testing is slower and more expensive." height="400px"/>
          <p>Source: https://martinfowler.com/bliki/TestPyramid.html</p>
        </section>

        <section>
          <p>To facilitate unit tests:</p>
          <ul>
            <li>Small functions that do one thing</li>
            <li>Use objects for everything</li>
          </ul>
        </section>

        <section>
          <pre>
            public function startEndDates(array $options, array $dates) {
              switch ($options['fromto']) {
                case 'value':
                  return array(
                    'date1' => $dates['value']['formatted'],
                    'date2' => $date1,
                  );
                case 'value2':
                  return array(
                    'date2' => $dates['value2']['formatted'],
                    'date1' => $date2,
                  );
                default:
                  return array(
                    'date1' => $dates['value']['formatted'],
                    'date2' => $dates['value2']['formatted'],
                  );
              }
            }
          </pre>
        </section>

        <section>
          <h2>Demo</h2>
          <ul>
            <li>Testing our function with PHPUnit</li>
            <li>Do not install PHPUnit, use Docker instead</li>
            <li>Regressions are easy to spot</li>
            <li>See https://github.com/alberto56/presentation_lets_unit_test_date</li>
          </ul>
        </section>

        <section>
          <h2>Making legacy code testable</h2>
          <ul>
            <li>Surgically remove the lines of code you want to test</li>
            <li>Add them as a class method or methods</li>
            <li>Test the method(s)</li>
            <li>Only then do you add improvements or fix bugs</li>
          </ul>
        </section>

        <section>
          <h2>Getting value from tests: CI and Docker</h2>
          <ul>
            <li>See https://circleci.com/gh/alberto56/presentation_lets_unit_test_date</li>
          </ul>
        </section>

        <section>
          <h2>Providers</h2>
          <ul>
            <li>Separate test logic from the data inputs and expected output.</li>
          </ul>
        </section>

        <section>
          <h2>Mocking and stubbing</h2>
          <ul>
            <li>Mocking: creating testable <em>objects</em>.</li>
            <li>Stubbing: creating testable <em>methods</em>.</li>
          </ul>
        </section>

        <section>
          <h2>Testing exceptions</h2>
        </section>

        <section>
          <h2>Expectations</h2>
          <ul>
            <li>Making sure your method calls other methods a set number of times.</li>
          </ul>
        </section>

        <section>
          <h2>Why not to use static methods</h2>
          <ul>
            <li>Static methods cannot be stubbed by PHPUnit.</li>
            <li>Use a singleton instead.</li>
          </ul>
        </section>

        <section>
          <h2>Traits</h2>
          <ul>
            <li>Different from inheritance.</li>
            <li>Allows classes to reuse methods.</li>
          </ul>
        </section>

        <section>
          <h2>Autoloading</h2>
        </section>

        <section>
          <h2>What next?</h2>
          <ul>
            <li>https://jtreminio.com/2013/03/unit-testing-tutorial-introduction-to-phpunit/</li>
            <li>https://hub.docker.com/r/phpunit/phpunit/</li>
            <li>https://circleci.com</li>
          </ul>
        </section>

        <section>
          <h2>Questions</h2>
        </section>

        <section>
          <h2>Let's unit test your code</h2>
          <p>by Albert Albala</p>
          <p>@alberto56 - Dcycle.com</p>
          <p>https://alberto56.github.io/presentation_lets_unit_test/#/</p>
          <p><a href="https://github.com/alberto56/presentation_lets_unit_test">Fork me</a></p>
        </section>

      </div>
    </div>

    <script src="lib/js/head.min.js"></script>
    <script src="js/reveal.js"></script>

    <script>
      // More info https://github.com/hakimel/reveal.js#configuration
      Reveal.initialize({
        history: true,

        // More info https://github.com/hakimel/reveal.js#dependencies
        dependencies: [
          { src: 'plugin/markdown/marked.js' },
          { src: 'plugin/markdown/markdown.js' },
          { src: 'plugin/notes/notes.js', async: true },
          { src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } }
        ]
      });
    </script>
  </body>
</html>
